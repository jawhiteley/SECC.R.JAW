                                           ),
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
##                 browser()
                panel.xyplot(X, predicted,
                             data = subset(preds,
                                           preds$Chamber ==
                                           levels(preds$Chamber)[1]
                                           ),
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
                browser()
                panel.xyplot(X, predicted,
                             data = subset(preds,
                                           preds$Chamber ==
                                           levels(preds$Chamber)[1]
                                           ),
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
preds
subset(preds, #
                                           preds$Chamber == #
                                           levels(preds$Chamber)[1]#
                                           )
n
n
Q
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
##                 browser()
                panel.xyplot(preds$X, preds$predicted,
                             data = subset(preds,
                                           preds$Chamber ==
                                           levels(preds$Chamber)[1]
                                           ),
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
                 browser()
                panel.xyplot(preds$X, preds$predicted,
                             data = subset(preds,
                                           preds$Chamber ==
                                           levels(preds$Chamber)[1]
                                           ),
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
n
preds
subset(preds, #
                                           preds$Chamber == #
                                           levels(preds$Chamber)[1]#
                                           )
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
                 browser()
                preds.1 <- subset(preds, preds$Chamber == levels(preds$Chamber)[1])
                panel.xyplot(preds.1$X, preds.2$predicted,
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
Q
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
                 browser()
                preds.1 <- subset(preds, preds$Chamber == levels(preds$Chamber)[1])
                panel.xyplot(preds.1$X, preds.2$predicted,
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
n
n
preds.1
n
Q
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
                 browser()
                preds.1 <- subset(preds, preds$Chamber == levels(preds$Chamber)[1])
                panel.xyplot(preds.1$X, preds.1$predicted,
                             type = 'l', col = Chamber.map$col[1]
                             )
              },
              subscripts = T
              )
)
n
n
n
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
##                  browser()
                for( lvl in levels(preds$Chamber ) {
                    preds.lvl <- subset(preds, preds$Chamber == lvl)
                    panel.xyplot(preds.lvl$X, preds.lvl$predicted,
                                 type = 'l',
                                 col = Chamber.map$col[Chamber.map$label == lvl]
                    )
                }
              },
              subscripts = T
              )
)
Q
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
##                  browser()
                for( lvl in levels(preds$Chamber ) {
                    preds.lvl <- subset(preds, preds$Chamber == lvl)
                    panel.xyplot(preds.lvl$X, preds.lvl$predicted,
                                 type = 'l',
                                 col = Chamber.map$col[Chamber.map$label == lvl]
                    )
                }
              },
              subscripts = T
              )
)
print( xyplot( Y ~ X | Frag * Position , data=SECCa,
              pch = SECCa$pt, col = SECCa$colr,
              panel = function(..., data, subscripts) {
                panel.xyplot(...)  # regular plot of data points
                Frag.lvl <- unique(SECCa$Frag[subscripts]) # get current factor levels
                Pos.lvl  <- unique(SECCa$Position[subscripts])
                preds    <- Y.pred[which(Y.pred$Frag %in% Frag.lvl
                                       & Y.pred$Position %in% Pos.lvl), ]
##                  browser()
                for( lvl in levels(preds$Chamber) ) {
                  preds.lvl <- subset(preds, preds$Chamber == lvl)
                  panel.xyplot(preds.lvl$X, preds.lvl$predicted,
                               type = 'l',
                               col = Chamber.map$col[Chamber.map$label == lvl]
                               )
                }
              },
              subscripts = T
              )
)
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
  getwd()  # Check that we're in the right place
source('./lib/init.R')
library(lattice)
X.col <- 'Cells.m'   # Column to analyze as explanatory variable        *****
Y.col <- 'ARA.m'     # Column to analyze as response variable           *****
vars.ls   <- c("ARA.m", "Cells.m", "Hcells.m")  # for data exploration?
Time.use     <- levels(SECC$Time)[1]      # Time (index: 1-3) to include in this run
Chamber.use  <- levels(SECC$Chamber)[c(1, 3)]      # Chamber treatments to include
Frag.use     <- levels(SECC$Frag)         # Frag treatments to include
Position.use <- levels(SECC$Position)[c(1, 3)]     # Patch Positions to include
Save.results  <- FALSE
SECC.prime <- SECC    # save a copy of the original for reference.
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
source("/tmp/r-plugin-jaw/Rsource-24114-ARA~cyanobacteria.R")
par(mfrow=c(2,2))	    # panel of figures: 3 rows & 2 columns
plot(Y.model)
par(mfrow=c(1,1))	    # panel of figures: 3 rows & 2 columns
hist(resid(Y.model))    # plot residuals
Y.model <- glm( Y.formula, data=SECCa, family="quasipoisson" )
par(mfrow=c(2,2))	    # panel of figures: 3 rows & 2 columns
plot(Y.model)
par(mfrow=c(1,1))	    # panel of figures: 3 rows & 2 columns
hist(resid(Y.model))    # plot residuals
